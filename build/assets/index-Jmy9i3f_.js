import{c as x,e as C,A as m,h as g,k as Q,j as e,F as V,a3 as Z,I as H,B as J,r as h,u as w,a as L,T as W,d as U,o as M,g as X}from"./index-BM3qoPaZ.js";import{A as Y}from"./workerSelect-DcrGUwmK.js";import"./seq-DyurWhFQ.js";import{u as K}from"./index.esm-D0zpTM6p.js";import{Z as ss}from"./index-B52W9T6s.js";import{C as es}from"./confirmModal-CQUKf-gX.js";const q=x("classSlice/createClassType",async l=>{const{request:s}=C();return await s(`${m}Class/class_types/`,"POST",JSON.stringify(l),g())}),D=x("classSlice/getClassTypes",async l=>{const{request:s}=C();return await s(`${m}Class/class_types/?branch=${l}`,"GET",null,g())}),A=x("classSlice/updateClassType",async({id:l,data:s})=>{const{request:a}=C();return await a(`${m}Class/class_types/${l}/`,"PATCH",JSON.stringify(s),g())}),B=x("classSlice/getClassTypeNumber",async l=>{const{request:s}=C();return await s(`${m}Class/class_number_list/`,"GET",null,g())}),O=x("classSlice/classItem",async({id:l,branchId:s})=>{const{request:a}=C();return await a(`${m}Class/class_number/${l}/?branch=${s}`,"GET",null,g())}),F=x("classSlice/updateClassItem",async({idClass:l,res:s})=>{const{request:a}=C();return await a(`${m}Class/class_number_update/${l}/`,"PUT",JSON.stringify(s),g())}),P=x("classSlice/createColor",async l=>{const{request:s}=C();return await s(`${m}Class/class_colors/`,"POST",JSON.stringify(l),g())}),R=x("classSlice/getColor",async()=>{const{request:l}=C();return await l(`${m}Class/class_colors/`,"GET",null,g())}),k=x("classSlice/updateColor",async({id:l,res:s})=>{const{request:a}=C();return await a(`${m}Class/class_colors/${l}/`,"PATCH",JSON.stringify(s),g())}),G=x("classSlice/fetchClassSubjects",async()=>{const{request:l}=C();return await l(`${m}Subjects/subject/`,"GET",null,g())}),E=x("classSlice/getClassNewNumberList",async({branchId:l,id:s})=>{const{request:a}=C();return await a(`${m}Class/class_number_subject_list?branch=${l}&id=${s}`,"GET",null,g())}),as={loading:!1,error:!1,classData:[],classTypeNumber:[],classItems:[],color:[],subjects:[],classNewItems:[]},ls=Q({name:"classSlice",initialState:as,reducers:{onDelete:(l,s)=>{l.color=l.color.filter(a=>a.id!==s.payload.id)},onDeleteTypes:(l,s)=>{l.classData=l.classData.filter(a=>a.id!==s.payload.id)},onChangeClassStatus:(l,s)=>{l.classNewItems=l.classNewItems.map(a=>a.id===s.payload.id?{...a,status:!a.status}:a)},onUpdateClass:(l,s)=>{l.classItems=l.classItems.map(a=>a.id===s.payload.id?{...a,price:s.payload.price,curriculum_hours:s.payload.curriculum_hours,subjects:s.payload.subjects}:a)}},extraReducers:l=>l.addCase(D.pending,s=>{s.loading=!0,s.error=!1}).addCase(D.fulfilled,(s,a)=>{s.classData=a.payload,s.loading=!1,s.error=!1}).addCase(D.rejected,s=>{s.error=!0,s.loading=!1}).addCase(q.pending,s=>{s.loading=!0,s.error=!1}).addCase(q.fulfilled,(s,a)=>{s.classData=[...s.classData,a.payload],s.loading=!1,s.error=!1}).addCase(q.rejected,s=>{s.error=!0,s.loading=!1}).addCase(A.pending,s=>{s.loading=!0,s.error=!1}).addCase(A.fulfilled,(s,a)=>{s.classData=[...s.classData.filter(o=>o.id!==a.payload.id),a.payload],s.loading=!1,s.error=!1}).addCase(A.rejected,s=>{s.error=!0,s.loading=!1}).addCase(B.pending,s=>{s.loading=!0,s.error=!1}).addCase(B.fulfilled,(s,a)=>{s.classTypeNumber=a.payload,s.loading=!1,s.error=!1}).addCase(B.rejected,s=>{s.error=!0,s.loading=!1}).addCase(O.pending,s=>{s.loading=!0,s.error=!1}).addCase(O.fulfilled,(s,a)=>{s.loading=!1,s.error=!1,s.classItems=a.payload}).addCase(O.rejected,s=>{s.loading=!1,s.error=!0}).addCase(F.pending,s=>{s.loading=!0,s.error=!1}).addCase(F.fulfilled,(s,a)=>{s.loading=!1,s.error=!1,s.classNewItems=s.classNewItems.map(o=>o.id===a.payload.id?{...o,price:a.payload.price,subjects:a.payload.subjects}:o)}).addCase(F.rejected,s=>{s.loading=!1,s.error=!0}).addCase(P.pending,s=>{s.loading=!0,s.error=!1}).addCase(P.fulfilled,(s,a)=>{s.loading=!1,s.error=!1,s.color=[...s.color,a.payload]}).addCase(P.rejected,s=>{s.loading=!1,s.error=!0}).addCase(R.pending,s=>{s.loading=!0,s.error=!1}).addCase(R.fulfilled,(s,a)=>{s.loading=!1,s.error=!1,s.color=a.payload}).addCase(R.rejected,s=>{s.loading=!1,s.error=!0}).addCase(k.pending,s=>{s.loading=!0,s.error=!1}).addCase(k.fulfilled,(s,a)=>{s.loading=!1,s.error=!1,s.color=[...s.color.filter(o=>o.id!==a.payload.id),a.payload]}).addCase(k.rejected,s=>{s.loading=!1,s.error=!0}).addCase(G.pending,s=>{s.loading=!0,s.error=!1}).addCase(G.fulfilled,(s,a)=>{s.subjects=a.payload,s.loading=!1,s.error=!1}).addCase(G.rejected,s=>{s.loading=!1,s.error=!0}).addCase(E.pending,s=>{s.loading=!0,s.error=!1}).addCase(E.fulfilled,(s,a)=>{s.classNewItems=a.payload,s.loading=!1,s.error=!1}).addCase(E.rejected,s=>{s.loading=!1,s.error=!0})}),{onDelete:rs,onDeleteTypes:Rs,onChangeClassStatus:cs,onUpdateClass:Gs}=ls.actions,ns="_modalBtn_1d7c7_10",ts="_extraClassForm_1d7c7_15",os="_modalHeader_1d7c7_57",ds="_items_1d7c7_65",is="_checkbox__minus_1d7c7_70",us="_active_1d7c7_79",ps="_changeColorItem_1d7c7_89",fs="_color_1d7c7_100",hs="_subject__main_1d7c7_107",Cs="_subject_1d7c7_107",v={modalBtn:ns,extraClassForm:ts,modalHeader:os,items:ds,checkbox__minus:is,active:us,changeColorItem:ps,color:fs,subject__main:hs,subject:Cs},ms=({handleSubmit:l,register:s,setActive:a,active:o,changeName:u,setChangeName:i,changeColor:d,setColorChange:t,colorChange:c,deleteColor:p,edit:f})=>(console.log(f),e.jsxs(V,{active:u,setActive:i,children:[e.jsx("h2",{children:"Rangni oz'gartirish yoki O'chirish"}),e.jsx("div",{children:e.jsxs(Z,{extraClassname:v.extraClassForm,typeSubmit:"",children:[e.jsx(H,{name:"name",register:s}),e.jsxs("div",{className:v.changeColorItem,children:[e.jsxs("div",{className:v.color,children:[e.jsx("h2",{children:"Tanlangan rang :"}),e.jsx("div",{style:{fontSize:"2rem"},children:c||f?.value})]}),e.jsx(ss,{style:{width:"30rem",height:"15rem"},color:f?.value,onChange:t})]}),e.jsxs("div",{style:{display:"flex",gap:"2rem"},children:[e.jsx(J,{onClick:l(d),children:"Rangni o'zgartirish"}),f?.status?e.jsx(J,{onClick:l(()=>a(!o)),type:"danger",children:"Rangni O'chirish"}):null]}),e.jsx(es,{setActive:a,active:o,onClick:l(p),type:"danger"})]})})]})),gs="_select_1d7c7_1",js="_extraClassForm_1d7c7_15",_s="_container_1d7c7_21",xs="_input_1d7c7_26",bs="_selectBox_1d7c7_34",I={select:gs,extraClassForm:js,container:_s,input:xs,selectBox:bs},ys=({selectOptions:l,editClass:s,setEditClass:a,edit:o,changedItem:u})=>{const[i,d]=h.useState([]),{register:t,handleSubmit:c,setValue:p}=K(),{request:f}=C(),N=w(),y=r=>{const n={subjects:i,...r},j=s;p("price",i.price),N(F({idClass:j,res:n})),a(!s)},[S,T]=h.useState([]);h.useEffect(()=>{u?.id&&(d(u.subjects.map(r=>({value:r.id,label:r.name}))),p("curriculum_hours",u.curriculum_hours),p("price",u.price))},[u?.id]),h.useEffect(()=>{l?.length&&T(l?.map(r=>({value:r.id,label:r.name})))},[l]),h.useEffect(()=>{s&&f(`${m}Class/class_subjects?id=${s}`,"GET",null,g()).then(r=>{d(r.hours.map(n=>({value:n.id,label:n.name,hours:n.hours})))})},[s]);const b=(r,n)=>{d(j=>j.map(_=>_.value===r&&n!==_?.hours?{..._,hours:n}:_))};return e.jsx(e.Fragment,{children:e.jsxs(V,{active:s,setActive:a,children:[e.jsx("h2",{children:"Ma’lumotlarni o’zgartirish "}),e.jsxs(Z,{extraClassname:I.extraClassForm,typeSubmit:"",onSubmit:c(y),children:[e.jsxs("div",{className:I.container,children:[e.jsxs("div",{children:[e.jsx(H,{name:"price",register:t,value:i.price,type:"number",placeholder:"narxi"}),e.jsx("div",{className:I.selectBox,children:e.jsx(Y,{extraClass:I.select,value:i,options:S,onChange:d})})]}),e.jsx("div",{className:I.input,children:i.map(r=>e.jsx(H,{value:r.hours,type:"number",title:r.label,onChange:n=>b(r.value,n.target.value)}))})]}),e.jsx(J,{children:"Tastiqlash"})]})]})})},zs=l=>l.classSlice.loading,Hs=l=>l.classSlice?.classData,Js=l=>l.classSlice?.color,Ss=l=>l.classSlice?.subjects,vs=l=>l.classSlice?.classNewItems,Ns=({edit:l})=>{const[s,a]=h.useState(!1),[o,u]=h.useState({}),i=L(Ss),d=L(vs),{request:t}=C(),c=w(),[p,f]=h.useState([]),[N,y]=h.useState(null);h.useEffect(()=>{if(s){const r=d.find(n=>n.id===s);y(r)}},[s,d]);const S=({id:r,type:n})=>{const j={status:!n,class_type_id:l.id,class_number_id:r};t(`${m}Class/class_number_update_status/`,"POST",JSON.stringify(j),g()).then(_=>{c(cs({id:r})),c(M({type:"success",status:!0,msg:_.msg}))}).catch(_=>{console.log(_)})},b=d.map((r,n)=>e.jsxs("tr",{children:[e.jsx("td",{children:n+1}),e.jsx("td",{children:r?.number}),e.jsx("td",{children:e.jsx("div",{className:v.subject__main,children:r?.subjects.map(j=>e.jsxs("span",{className:v.subject,children:[" ",j.name,"-",j.hours]}))})}),e.jsx("td",{children:r.price}),e.jsx("td",{style:{width:"3rem"},children:e.jsxs("div",{className:v.items,children:[e.jsx("div",{onClick:()=>S({id:r.id,type:r.status}),className:U(v.checkbox__minus,{[v.active]:r.status}),children:r.status?e.jsx("i",{className:"fa fa-check "}):e.jsx("i",{className:"fa fa-minus"})}),e.jsx("i",{onClick:()=>{a(r.id),u(r)},className:"fa fa-pen"})]})})]}));return e.jsxs("div",{children:[e.jsxs(W,{children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"No"}),e.jsx("th",{children:"Sinf Raqami"}),e.jsx("th",{children:"Fanlari"}),e.jsx("th",{children:"Narxi"}),e.jsx("th",{})]})}),e.jsx("tbody",{children:b})]}),e.jsx(ys,{setEditClass:a,selectOptions:i,editClass:s,changedItem:o,edit:l})]})},Ts="_classFilter_12547_1",Is="_active_12547_28",$={classFilter:Ts,active:Is},ws=({classesType:l,active:s,setActive:a,setEdit:o})=>{const u=w(),i=L(X),d=h.useCallback(c=>{u(E({branchId:i.id,id:c}))},[i]);function t(c,p){return c.id-p.id}return e.jsx("div",{className:$.classFilter,children:e.jsx("div",{className:$.classFilter__wrapper,children:e.jsx("ul",{children:[...l].sort(t)?.map((c,p)=>e.jsxs("li",{className:U($.classFilter_li,{[$.active]:s===c?.id}),onClick:()=>{d(c.id),a(c.id),o({id:c.id,name:c.name})},children:[c?.name,e.jsx("div",{children:c.class_numbers?.map(f=>e.jsx("span",{children:f?.number}))})]},p))})})})},$s="_filter__wrapper_5nrwu_1",z={filter__wrapper:$s},Fs=({color:l,setEdit:s,setChangeName:a,changeName:o,setValue:u})=>{const d=l.map((t,c)=>{function p(S){var T=/^#?([a-f\d])([a-f\d])([a-f\d])$/i;S=S.replace(T,function(r,n,j,_){return n+n+j+j+_+_});var b=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(S);return b?{r:parseInt(b[1],16),g:parseInt(b[2],16),b:parseInt(b[3],16)}:null}const f=p(t?.value?t?.value:"#ffffff"),N=Math.round((parseInt(f?.r)*299+parseInt(f?.g)*587+parseInt(f?.b)*114)/1e3),y={backgroundColor:t?.value?t?.value:"white",color:N>125?"black":"white"};return e.jsxs("li",{style:y,className:U(z.classFilter_li),onClick:()=>{s(t),u("name",t.name),a(!o)},children:[t.name,e.jsx("span",{children:t.class})]},c)});return e.jsx("div",{className:z.filter,children:e.jsx("div",{className:z.filter__wrapper,children:e.jsx("ul",{children:d})})})},ks=({setEdit:l,edit:s,setActiveEdit:a,activeMenu:o,setActiveMenu:u,classes:i,branch:d})=>{const[t,c]=h.useState([]);w();const p=s.id;return e.jsxs(e.Fragment,{children:[e.jsx(ws,{classesType:i,setActiveEdit:a,edit:s,setEdit:l,active:o,setActive:u,branch:d}),e.jsx(Ns,{id:p,active:o,selectBox:t,setSelectBox:c,edit:s})]})},Es=({color:l,setEdit:s,edit:a})=>{const{register:o,handleSubmit:u,setValue:i}=K(),[d,t]=h.useState(!1),c=w(),[p,f]=h.useState(!1),{request:N}=C(),[y,S]=h.useState(""),T=r=>{const n=a.id,j={value:y||a.value,...r};c(k({id:n,res:j})),i("name",""),t(!d),c(M({msg:"rang muvaffaqiyatli o'zgartirildi",status:!0,type:"success"}))},b=()=>{const r=a.id;N(`${m}Class/class_colors-delete/${r}/`,"DELETE",null,g()).then(n=>{c(rs({id:r})),t(!d),f(!1),c(M({msg:n.msg,status:!0,type:"success"}))}).catch(n=>{console.log(n)})};return e.jsxs(e.Fragment,{children:[e.jsx(Fs,{color:l,edit:a,setEdit:s,changeName:d,setChangeName:t,setValue:i}),e.jsx(ms,{setActive:f,active:p,edit:a,changeName:d,setChangeName:t,changeColor:T,handleSubmit:u,register:o,colorChange:y,setColorChange:S,deleteColor:b})]})},Ls=Object.freeze(Object.defineProperty({__proto__:null,ClassAddColorPage:Es,ClassPage:ks},Symbol.toStringTag,{value:"Module"}));export{ks as C,P as a,q as b,v as c,Hs as d,Js as e,zs as f,D as g,R as h,G as i,Es as j,Ls as k,Rs as o,A as u};
