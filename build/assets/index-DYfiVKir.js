import{a as x,r as t,ab as M,u as L,e as N,A,h as D,j as e,D as R,T as E,ac as q,ad as V,ae as B,af as H,o as G,g as K,ag as U,ah as Y,ai as z,S}from"./index-CTtC1zcc.js";import{g as J,a as Q,b as W,c as X,p as Z,d as ee,e as te,y as se,f as ae,T as oe}from"./taskManagerRight-CNk1_UGu.js";import"./textArea-xhti2b3I.js";import{u as ne}from"./index.esm-X1Z8qUg7.js";import{C as re}from"./confirmModal-DQuz2eI0.js";import{e as ce}from"./oftenUsedSelector-DDKSaiMY.js";import"./clsx-B-dksMZM.js";const le="_container_m9xps_2",de="_box_m9xps_9",_e="_box__header_m9xps_19",ie="_select_m9xps_26",he="_box__header_title_m9xps_29",xe="_box__sides_m9xps_37",m={container:le,box:de,box__header:_e,select:ie,box__header_title:he,box__sides:xe},ue="_taskLeft_1h6ng_1",fe="_taskLeft__header_1h6ng_20",me="_taskLeft__header_box_1h6ng_24",ge="_taskLeft__header_box_top_1h6ng_33",be="_taskLeft__header_box_count_1h6ng_41",je="_taskLeft__body_1h6ng_46",ke="_taskLeft__body_table_1h6ng_52",pe="_taskLeft__body_main_1h6ng_58",Le="_taskLeft__body_title_1h6ng_66",ye="_taskLeft__body_card_1h6ng_69",ve="_taskLeft__body_card_cotainer_1h6ng_74",o={taskLeft:ue,taskLeft__header:fe,taskLeft__header_box:me,taskLeft__header_box_top:ge,taskLeft__header_box_count:be,taskLeft__body:je,taskLeft__body_table:ke,taskLeft__body_main:pe,taskLeft__body_title:Le,taskLeft__body_card:ye,taskLeft__body_card_cotainer:ve},w=t.createContext(null),T=["Tel ko'tardi","Tel ko'tarmadi"],Ce=({formatted:s,setTaskType:n,taskType:d})=>{const u=x(J),_=x(Q),[k,g]=t.useState(null),[j,i]=t.useState(null),h=x(W),[c,b]=t.useState(null),r=M(new Date),[I,y]=t.useState(!1),[O,v]=t.useState(null),{register:Me,handleSubmit:Ne,setValue:Ae}=ne(),C=x(X),{request:F}=N();L(),t.useEffect(()=>{h&&y(!1)},[h]);const p={red:[],yellow:[],green:[]};C?.forEach(a=>{p[a?.color]&&p[a?.color].push(a)}),t.useEffect(()=>{g(T[0])},[T]);const P=t.useCallback(a=>{y(!0),v(a),F(`${A}Lead/lead_call/${a.id}`,"GET",null,D()).then(l=>{console.log(l,"nma gap"),b(l.history)}).catch(l=>{console.log(l)})}),$=t.useMemo(()=>({activeModal:I,setActiveModal:a=>P(a),activeModalItem:O,setActiveModalItem:v,taskType:d}),[]);return e.jsxs("div",{className:o.taskLeft,children:[e.jsxs("div",{className:o.taskLeft__header,children:[r===s&&e.jsxs("div",{onClick:()=>n("progress"),className:o.taskLeft__header_box,style:{background:"rgba(249, 145, 75, 1)"},children:[e.jsxs("div",{className:o.taskLeft__header_box_top,children:[e.jsx("img",{src:Z,alt:""}),e.jsxs("h2",{style:{whiteSpace:"pre-line"},children:["Task ",e.jsx("br",{}),"in Progress"]})]}),e.jsx("div",{className:o.taskLeft__header_box_count,children:_})]}),e.jsxs("div",{className:o.taskLeft__header_box,onClick:()=>n("completed"),style:{background:"rgba(26, 174, 204, 1)"},children:[e.jsxs("div",{className:o.taskLeft__header_box_top,children:[e.jsx("img",{src:ee,alt:""}),e.jsxs("h2",{style:{whiteSpace:"pre-line"},children:["Project",e.jsx("br",{}),"Completed"]})]}),e.jsx("div",{className:o.taskLeft__header_box_count,children:u})]})]}),e.jsx(w.Provider,{value:$,children:e.jsxs("div",{className:o.taskLeft__body,children:[e.jsx("h1",{className:o.taskLeft__body_title,children:d==="completed"?"Completed leads":"Leads"}),h?e.jsx(R,{}):s===r?e.jsx(e.Fragment,{children:e.jsx("div",{className:o.taskLeft__body_main,children:e.jsx("div",{className:o.taskLeft__body_card,children:Object.entries(p).map(([a,l])=>l.length?e.jsx(Se,{taskType:d,items:l,className:o.taskLeft__body_card_cotainer},a+d):null)})})}):e.jsx(e.Fragment,{children:e.jsx("div",{className:o.taskLeft__body_table,children:e.jsxs(E,{children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{}),e.jsx("th",{children:"Ism"}),e.jsx("th",{children:"Familiya"}),e.jsx("th",{children:"Kament"}),e.jsx("th",{children:"Tel raqami"}),e.jsx("th",{children:"Tel statusi"}),e.jsx("th",{children:"Yaratilgan sana"})]})}),e.jsx("tbody",{children:C?.map((a,l)=>e.jsxs("tr",{children:[e.jsx("td",{children:l+1}),e.jsx("td",{children:a?.lead?.name}),e.jsx("td",{children:a?.lead?.surname}),e.jsx("td",{children:a?.comment}),e.jsx("td",{children:a?.lead?.phone}),e.jsx("td",{children:a.status===!0?"Tel ko'tardi":"Tel ko'tarilmadi"}),e.jsx("td",{children:a?.lead?.created})]},l))})]})})})]})})]})},Se=({items:s=[],className:n="",taskType:d})=>e.jsxs(E,{children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"â„–"}),e.jsx("th",{children:"Ism"}),e.jsx("th",{children:"Familiya"}),e.jsx("th",{children:"Telefon nomer"})]})}),e.jsx("tbody",{children:s.map((u,_)=>e.jsx(Te,{item:u,i:_},_))})]}),Te=({item:s,i:n})=>{const[d,u]=t.useState({}),{setActiveModal:_,setActiveModalItem:k,taskType:g}=t.useContext(w),[j,i]=t.useState(!1),{request:h}=N(),c=L(),b=r=>{switch(r){case"red":return`url(${ae})`;case"yellow":return`url(${se})`;case"green":return`url(${te})`;default:return""}},f=()=>{h(`${A}Lead/lead_delete/${s.id}`,"DELETE",null,D()).then(r=>{console.log(r),i(!1),c(q(s.id)),c(V(r.accepted_percentage)),c(B(r.completed)),c(H(r.progressing)),c(G({type:"success",status:!0,msg:"Muvaffaqiyatli o'chirildi"}))}).catch(r=>{console.log(r)})};return t.useEffect(()=>{u({backImage:b(s?.color),color:s?.color==="green"?"rgba(220, 252, 231, 1)":s.color==="yellow"?"rgba(254, 249, 195, 1)":"rgba(255, 228, 230, 1)"})},[s?.color]),e.jsxs(e.Fragment,{children:[e.jsxs("tr",{style:{background:d.color},children:[e.jsx("td",{children:n+1}),e.jsx("td",{children:s.name}),e.jsx("td",{children:s.surname}),e.jsx("td",{children:s.phone})]}),e.jsx(re,{active:j,setActive:i,onClick:f})]})},$e=()=>{const s=L(),[n,d]=t.useState(),{id:u}=x(K),_=x(ce),k=x(U),[g,j]=t.useState(new Date),[i,h]=t.useState("all"),[c,b]=t.useState("progress"),f=M(g);return t.useEffect(()=>{s(Y({operator_id:i,date:f,branch:n,taskType:c}))},[i,f,c,n]),t.useEffect(()=>{s(z(n))},[n]),console.log(n),e.jsx("div",{className:m.container,children:e.jsxs("div",{className:m.box,children:[e.jsxs("div",{className:m.box__header,children:[e.jsx("h1",{className:m.box__header_title,children:"Task Manager"}),e.jsxs("div",{style:{display:"flex",gap:"2rem"},children:[e.jsx(S,{defaultValue:n,onChangeOption:d,options:k,title:"Branch"}),e.jsx(S,{defaultValue:i,onChangeOption:h,extraClass:m.select,title:"Operators",options:[..._,{name:"Hammasi",id:"all"}]})]})]}),e.jsxs("div",{className:m.box__sides,children:[e.jsx(Ce,{setTaskType:b,taskType:c,formatted:f}),e.jsx(oe,{selectedDate:g,setSelectedDate:j})]})]})})};export{$e as AdminTaskManager};
