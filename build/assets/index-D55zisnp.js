import{a as f,r as t,ab as T,u as p,e as M,A as N,h as A,j as e,D as F,T as D,ac as R,ad as q,ae as B,af as H,o as V,g as G,ag as K,ah as U,ai as Y,S as z}from"./index-BEMsgrdT.js";import{g as J,a as Q,b as W,c as X,p as Z,d as ee,e as te,y as se,f as ae,T as oe}from"./taskManagerRight-BbIqO_XQ.js";import"./textArea-IhfEmLmW.js";import{u as re}from"./index.esm-DWlg3cF3.js";import{C as ce}from"./confirmModal-BVLRU1gM.js";import{e as de}from"./oftenUsedSelector-DDKSaiMY.js";import"./clsx-B-dksMZM.js";const ne="_container_e3kfj_2",le="_box_e3kfj_7",_e="_box__header_e3kfj_16",ie="_select_e3kfj_23",he="_box__header_title_e3kfj_26",xe="_box__sides_e3kfj_34",u={container:ne,box:le,box__header:_e,select:ie,box__header_title:he,box__sides:xe},ue="_taskLeft_14ud8_1",fe="_taskLeft__header_14ud8_20",be="_taskLeft__header_box_14ud8_24",je="_taskLeft__header_box_top_14ud8_33",me="_taskLeft__header_box_count_14ud8_41",ke="_taskLeft__body_14ud8_46",ge="_taskLeft__body_table_14ud8_52",pe="_taskLeft__body_main_14ud8_58",Le="_taskLeft__body_title_14ud8_66",ye="_taskLeft__body_card_14ud8_69",Ce="_taskLeft__body_card_cotainer_14ud8_74",o={taskLeft:ue,taskLeft__header:fe,taskLeft__header_box:be,taskLeft__header_box_top:je,taskLeft__header_box_count:me,taskLeft__body:ke,taskLeft__body_table:ge,taskLeft__body_main:pe,taskLeft__body_title:Le,taskLeft__body_card:ye,taskLeft__body_card_cotainer:Ce},E=t.createContext(null),S=["Tel ko'tardi","Tel ko'tarmadi"],ve=({formatted:s,setTaskType:l,taskType:d})=>{const _=f(J),i=f(Q),[b,m]=t.useState(null),[h,j]=t.useState(null),n=f(W),[x,k]=t.useState(null),r=T(new Date),[w,y]=t.useState(!1),[I,C]=t.useState(null),{register:Me,handleSubmit:Ne,setValue:Ae}=re(),v=f(X),{request:O}=M();p(),t.useEffect(()=>{n&&y(!1)},[n]);const g={red:[],yellow:[],green:[]};v?.forEach(a=>{g[a?.color]&&g[a?.color].push(a)}),t.useEffect(()=>{m(S[0])},[S]);const P=t.useCallback(a=>{y(!0),C(a),O(`${N}Lead/lead_call/${a.id}`,"GET",null,A()).then(c=>{console.log(c,"nma gap"),k(c.history)}).catch(c=>{console.log(c)})}),$=t.useMemo(()=>({activeModal:w,setActiveModal:a=>P(a),activeModalItem:I,setActiveModalItem:C,taskType:d}),[]);return e.jsxs("div",{className:o.taskLeft,children:[e.jsxs("div",{className:o.taskLeft__header,children:[r===s&&e.jsxs("div",{onClick:()=>l("progress"),className:o.taskLeft__header_box,style:{background:"rgba(249, 145, 75, 1)"},children:[e.jsxs("div",{className:o.taskLeft__header_box_top,children:[e.jsx("img",{src:Z,alt:""}),e.jsxs("h2",{style:{whiteSpace:"pre-line"},children:["Task ",e.jsx("br",{}),"in Progress"]})]}),e.jsx("div",{className:o.taskLeft__header_box_count,children:i})]}),e.jsxs("div",{className:o.taskLeft__header_box,onClick:()=>l("completed"),style:{background:"rgba(26, 174, 204, 1)"},children:[e.jsxs("div",{className:o.taskLeft__header_box_top,children:[e.jsx("img",{src:ee,alt:""}),e.jsxs("h2",{style:{whiteSpace:"pre-line"},children:["Project",e.jsx("br",{}),"Completed"]})]}),e.jsx("div",{className:o.taskLeft__header_box_count,children:_})]})]}),e.jsx(E.Provider,{value:$,children:e.jsxs("div",{className:o.taskLeft__body,children:[e.jsx("h1",{className:o.taskLeft__body_title,children:d==="completed"?"Completed leads":"Leads"}),n?e.jsx(F,{}):s===r?e.jsx(e.Fragment,{children:e.jsx("div",{className:o.taskLeft__body_main,children:e.jsx("div",{className:o.taskLeft__body_card,children:Object.entries(g).map(([a,c])=>c.length?e.jsx(Se,{taskType:d,items:c,className:o.taskLeft__body_card_cotainer},a+d):null)})})}):e.jsx(e.Fragment,{children:e.jsx("div",{className:o.taskLeft__body_table,children:e.jsxs(D,{children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{}),e.jsx("th",{children:"Ism"}),e.jsx("th",{children:"Familiya"}),e.jsx("th",{children:"Kament"}),e.jsx("th",{children:"Tel raqami"}),e.jsx("th",{children:"Tel statusi"}),e.jsx("th",{children:"Yaratilgan sana"})]})}),e.jsx("tbody",{children:v?.map((a,c)=>e.jsxs("tr",{children:[e.jsx("td",{children:c+1}),e.jsx("td",{children:a?.lead?.name}),e.jsx("td",{children:a?.lead?.surname}),e.jsx("td",{children:a?.comment}),e.jsx("td",{children:a?.lead?.phone}),e.jsx("td",{children:a.status===!0?"Tel ko'tardi":"Tel ko'tarilmadi"}),e.jsx("td",{children:a?.lead?.created})]},c))})]})})})]})})]})},Se=({items:s=[],className:l="",taskType:d})=>e.jsxs(D,{children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"â„–"}),e.jsx("th",{children:"Ism"}),e.jsx("th",{children:"Familiya"}),e.jsx("th",{children:"Telefon nomer"})]})}),e.jsx("tbody",{children:s.map((_,i)=>e.jsx(Te,{item:_,i},i))})]}),Te=({item:s,i:l})=>{const[d,_]=t.useState({}),{setActiveModal:i,setActiveModalItem:b,taskType:m}=t.useContext(E),[h,j]=t.useState(!1),{request:n}=M(),x=p(),k=r=>{switch(r){case"red":return`url(${ae})`;case"yellow":return`url(${se})`;case"green":return`url(${te})`;default:return""}},L=()=>{n(`${N}Lead/lead_delete/${s.id}`,"DELETE",null,A()).then(r=>{console.log(r),j(!1),x(R(s.id)),x(q(r.accepted_percentage)),x(B(r.completed)),x(H(r.progressing)),x(V({type:"success",status:!0,msg:"Muvaffaqiyatli o'chirildi"}))}).catch(r=>{console.log(r)})};return t.useEffect(()=>{_({backImage:k(s?.color),color:s?.color==="green"?"rgba(220, 252, 231, 1)":s.color==="yellow"?"rgba(254, 249, 195, 1)":"rgba(255, 228, 230, 1)"})},[s?.color]),e.jsxs(e.Fragment,{children:[e.jsxs("tr",{style:{background:d.color},children:[e.jsx("td",{children:l+1}),e.jsx("td",{children:s.name}),e.jsx("td",{children:s.surname}),e.jsx("td",{children:s.phone})]}),e.jsx(ce,{active:h,setActive:j,onClick:L})]})},Fe=()=>{const s=p(),{id:l}=f(G),d=f(de),[_,i]=t.useState(new Date),[b,m]=t.useState("all"),[h,j]=t.useState("progress"),n=T(_);return t.useEffect(()=>{s(K({operator_id:b,date:n,branch:l,taskType:h}))},[b,n,h]),t.useEffect(()=>{s(U()),s(Y(l))},[]),e.jsx("div",{className:u.container,children:e.jsxs("div",{className:u.box,children:[e.jsxs("div",{className:u.box__header,children:[e.jsx("h1",{className:u.box__header_title,children:"My Projects"}),e.jsx(z,{defaultValue:b,onChangeOption:m,extraClass:u.select,title:"Operators",options:[...d,{name:"Hammasi",id:"all"}]})]}),e.jsxs("div",{className:u.box__sides,children:[e.jsx(ve,{setTaskType:j,taskType:h,formatted:n}),e.jsx(oe,{selectedDate:_,setSelectedDate:i})]})]})})};export{Fe as AdminTaskManager};
