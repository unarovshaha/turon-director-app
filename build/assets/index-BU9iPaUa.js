import{a as m,L as _e,u as ue,r as o,g as de,E as ge,C as pe,X as xe,Y as he,Z as fe,_ as be,j as e,S as _,I as r,M as je,B as ye,e as Ce,A as Se,h as Ne,$ as Te,a0 as B,a1 as ve,a2 as qe,o as R}from"./index-BM3qoPaZ.js";import{u as Oe}from"./index.esm-D0zpTM6p.js";import"./vacancyPageAddThunk-FiVlINKL.js";import{g as De}from"./selectors-DKdp24P0.js";import{T as ke}from"./textArea-BKEd2Xap.js";import"./branchCreateSlice-B2WRecz7.js";import{g as Ae}from"./systemSelector-CUSI55rJ.js";import{A as P}from"./workerSelect-DcrGUwmK.js";import{a as Me,g as Ue,b as Ee,c as Fe}from"./oftenUsedSelector-DDKSaiMY.js";import{g as Ie}from"./userProfileSelector-DVds6RNm.js";import"./TransitionGroupContext-DJ0EBQK-.js";import"./TransitionGroup-CzGD1ptB.js";import"./Transition-DuhneECP.js";const Le=q=>q.registerUser.categories,we="_registerBtn_1mt0n_1",Be="_login_1mt0n_5",Re="_login__boxes_1mt0n_14",Pe="_login__boxes__login__box_1mt0n_22",Ve="_login__boxes__box_1mt0n_26",ze="_login__boxes__box__headerTitle_1mt0n_31",Je="_login__boxes__box__form_1mt0n_35",$e="_login__aside_1mt0n_44",Ke="_login__aside__img_1mt0n_52",Xe="_selection_1mt0n_58",He="_extraClasss_1mt0n_63",We="_extraClasses_1mt0n_67",Ye="_multiSelect_1mt0n_71",Ze="_resume_1mt0n_76",Ge="_resume__input_1mt0n_81",Qe="_mess_1mt0n_85",es="_errorMess_1mt0n_89",ss="_successMess_1mt0n_96",ts="_seriya_1mt0n_103",s={registerBtn:we,login:Be,login__boxes:Re,login__boxes__login__box:Pe,login__boxes__box:Ve,login__boxes__box__headerTitle:ze,login__boxes__box__form:Je,login__aside:$e,login__aside__img:Ke,selection:Xe,extraClasss:He,extraClasses:We,multiSelect:Ye,resume:Ze,resume__input:Ge,mess:Qe,errorMess:es,successMess:ss,seriya:ts},as="/assets/reg__bg-CnMNd682.svg",rs={types:[{value:"student",name:"Student"},{value:"teacher",name:"Teacher"},{value:"employer",name:"Employer"}]},V=[{id:1,name:"1 smen"},{id:2,name:"2 smen"},{id:3,name:"hamma vaqt"}],js=()=>{const O=m(De)?.map(t=>({id:t.group.id,name:t.group.name}))||[],C=m(Me),x=m(Ue),D=m(Ee),z=m(Fe),{register:a,handleSubmit:J,watch:k,setValue:n,reset:ns}=Oe(),u=k("registerType","student"),S=k("username","");_e(),m(Ae);const d=JSON.parse(localStorage.getItem("selectedSystem"));localStorage.getItem("selectedBranch");const $=m(Le),c=ue(),[os,K]=o.useState(!1),[X,N]=o.useState(1),[A,M]=o.useState(1),[H,U]=o.useState(1),[W,E]=o.useState(1),[Y,Z]=o.useState(1),[G,Q]=o.useState(),[ee,se]=o.useState(),[te,T]=o.useState(!1),{request:ae}=Ce(),[F,h]=o.useState(""),[I,f]=o.useState(!0),re=Array.isArray(C)?C:[C],[ne,oe]=o.useState(""),g=m(de),j=m(Ie),L=re?.map(t=>({value:t?.id,label:t?.name})),ie=O.filter(t=>t.name.toLowerCase()!=="admin"&&t.name.toLowerCase()!=="director");o.useEffect(()=>{j&&j?.job&&oe(j.job.toString())},[j]);const w=t=>{M(t)};o.useEffect(()=>{g&&(c(ge()),c(pe()),c(xe({branch:g.id})),c(he({branch:g.id})),c(fe(g.id))),n("password",12345678)},[g]),o.useEffect(()=>{c(be())},[]),o.useEffect(()=>{S?(async()=>{try{const b=await await ae(`${Se}Users/username-check/`,"POST",JSON.stringify({username:S}),Ne());b.exists===!0?(h(e.jsxs("p",{className:s.errorMess,children:[e.jsx("i",{className:"fa-solid fa-circle-exclamation",style:{color:"#f15c5c"}}),"Username band"]})),f(!1)):b.exists===!1&&(h(e.jsxs("p",{className:s.successMess,children:[e.jsx("i",{className:"fa-solid fa-circle-check"}),"Username bo'sh"]})),f(!0))}catch(y){console.error("Error checking username:",y),h("Error checking username"),f(!1)}})():(h(e.jsx("p",{children:"Username kiriting"})),f(!1))},[S]);const le=t=>{if(!I)return;T(!0);const y=V.find(l=>l.id===Number(H)),b=x.find(l=>l.id===Number(X));let i={user:{...t,observer:!0,language:b?.id,branch:g.id}},v={...t,observer:!0,language:b?.id||"",branch:g.id},p;if(u==="student"){let l;d?.name==="school"?l={class_number:Y,parents_fullname:t.parents_fullname,old_school:t.old_school,parent_region:t.parent_region,district:t.district,parent_seria:t.parent_seria,parent_seria_num:t.parent_seria_num,region:t.region,born_date:t.born_date,student_seria_num:t.student_seria_num,student_seria:t.student_seria}:l={subject:A.map(me=>me.value)||null},i={...i,shift:y?.id||"",parents_number:t.parents_phone,...l},p=Te(i)}else u==="teacher"?d?.name==="school"?(i={...i,total_students:1212,color:"red",class_type:+G,teacher_salary_type:ee,subject:A.map(l=>l.value)||null},p=B({res:i,file:i?.user?.resume})):(i={...i,total_students:1212},p=B(i)):u==="employer"&&(v={...v,profession:Number(W)},p=ve(v));p&&(u==="teacher"&&d?.name==="school"&&c(qe({id:i?.user?.username,file:i?.user?.resume})),c(p).then(l=>{T(!1),l.type.endsWith("fulfilled")?(c(R({type:"success",status:!0,msg:`${u} muvofaqqiyatli qo'shildi`})),M(1),U(1),E(1),h(""),f(!0),n("name",""),n("surname",""),n("username",""),n("parents_fullname",""),n("parent_seria",""),n("parent_seria_num",""),n("parent_region",""),n("born_date",""),n("father_name",""),n("parents_phone",""),n("phone",""),n("student_seria_num",""),n("student_seria",""),n("old_school",""),n("region",""),n("district",""),n("birth_date",""),n("comment","")):(c(R({type:"error",status:!0,msg:"Internet yoki serverda xatolik qayta urinib ko'ring"})),K(!0),T(!1))}))},ce=()=>{switch(u){case"student":return e.jsxs(e.Fragment,{children:[e.jsx(_,{extraClass:s.extraClasses,title:"Til",name:"language",onChangeOption:N,options:x,defaultValue:x[0]?.id}),d?.name==="school"?e.jsxs(e.Fragment,{children:[e.jsx(_,{extraClass:s.extraClasses,title:"Sinf",name:"class_number",onChangeOption:Z,options:D,defaultValue:D[0]?.id}),e.jsx(r,{register:a,placeholder:"Ota-ona telefon raqami",type:"number",required:!0,name:"parents_phone"}),e.jsx(r,{register:a,name:"parents_fullname",placeholder:"ota-ona fio"}),e.jsxs("div",{className:s.seriya,children:[e.jsx(r,{register:a,name:"parent_seria",placeholder:"passport seriya"}),e.jsx(r,{register:a,name:"parent_seria_num",placeholder:"seriya raqami",type:"number"})]}),e.jsx(r,{register:a,name:"born_date",placeholder:"tug'ilgan yili ",type:"date"}),e.jsx(r,{register:a,name:"parent_region",placeholder:"yashash joyi"})]}):e.jsxs(e.Fragment,{children:[e.jsx(P,{options:L,onChange:w,extraClass:s.multiSelect,fontSize:15}),e.jsx(_,{title:"Kelish vaqti",extraClass:s.extraClasses,name:"shift",onChangeOption:U,options:V})]})]});case"teacher":return e.jsxs(e.Fragment,{children:[e.jsx(_,{extraClass:s.extraClasses,name:"language",title:"Til",onChangeOption:N,options:x}),e.jsx(P,{options:L,onChange:w,extraClass:s.multiSelect,fontSize:15}),d?.name==="school"&&e.jsxs(e.Fragment,{children:[e.jsx(_,{extraClass:s.extraClasses,name:"category",options:$,onChangeOption:se,title:"Toifa"}),e.jsx(_,{extraClass:s.extraClasses,name:"class_type",options:z,onChangeOption:Q,title:"Sinf turi"}),e.jsxs("div",{className:s.resume,children:[e.jsx("h2",{style:{textAlign:"left",fontSize:"2rem"},children:"Resume"}),e.jsx(r,{type:"file",name:"file",register:a,extraClassName:s.resume__input})]})]})]});case"employer":return e.jsxs(e.Fragment,{children:[e.jsx(_,{extraClass:s.extraClasses,name:"language",onChangeOption:N,options:x}),e.jsx(_,{extraClass:s.extraClasses,name:"profession",onChangeOption:E,options:ne==="director"?O:ie}),e.jsxs("div",{className:s.resume,children:[e.jsx("h2",{style:{textAlign:"left",fontSize:"2rem"},children:"Resume"}),e.jsx(r,{type:"file",name:"resume",register:a,extraClassName:s.resume__input})]})]})}};return e.jsxs("div",{className:s.login,children:[e.jsx("div",{className:s.selection,children:e.jsx(_,{defaultValue:"student",options:rs.types,onChangeOption:t=>n("registerType",t)})}),e.jsxs("div",{className:s.login__boxes,children:[e.jsxs("div",{className:s.login__boxes__login__box,children:[e.jsx("h1",{className:s.login__boxes__box__headerTitle,children:"Registratsiya"}),e.jsx("div",{className:s.login__boxes__box__form,children:e.jsxs("form",{onSubmit:J(le),children:[e.jsx(r,{title:F&&e.jsx("p",{className:s.mess,children:F}),register:a,placeholder:"Username",required:!0,extraClassName:s.extraClasss,name:"username"}),e.jsx(r,{register:a,placeholder:"Ism",required:!0,name:"name"}),e.jsx(r,{register:a,placeholder:"Familiya",required:!0,name:"surname"}),e.jsx(r,{register:a,placeholder:"Otasi ismi",required:!0,name:"father_name"}),d?.name==="school"&&u==="student"?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:s.seriya,children:[e.jsx(r,{register:a,name:"student_seria",placeholder:"seriya"}),e.jsx(r,{name:"student_seria_num",register:a,type:"number",placeholder:"metrka raqami"})]}),e.jsx(r,{register:a,name:"old_school",placeholder:"kelgan maktabi"}),e.jsx(r,{register:a,name:"region",placeholder:"Xudud nomi"}),e.jsx(r,{register:a,name:"district",placeholder:"Tuman shaxar nomi"})]}):null,e.jsx(r,{register:a,placeholder:"Parol",required:!0,type:"password",name:"password"}),e.jsx(r,{register:a,placeholder:"Tug'ilgan kun",type:"date",required:!0,name:"birth_date"}),e.jsx(r,{register:a,placeholder:"Telefon raqami",type:"number",required:!0,name:"phone"}),d?.name==="center "&&u==="student"?e.jsx(r,{register:a,placeholder:"Ota-ona telefon raqami",type:"number",required:!0,name:"parents_phone"}):null,e.jsx(ke,{register:a,placeholder:"Kommentariya",name:"comment"}),ce(),te?e.jsx(je,{}):e.jsx(ye,{type:I?"submit":"disabled",extraClass:s.registerBtn,children:"Register"})]})})]}),e.jsx("div",{className:s.login__aside,children:e.jsx("img",{className:s.login__aside__img,src:as,alt:""})})]})]})};export{js as Register};
