import{a as m,g as je,u as Q,b as W,r as o,j as e,B as b,d as u,T as R,F as T,a3 as V,S as q,a4 as f,H as fe,I as J,e as X,A as U,h as H,aj as ve,o as E,z as ge,ak as pe,D as be}from"./index-CTtC1zcc.js";import{g as Z,a as Ne,b as Ie,c as Le,f as Me,d as A,e as Ce,h as Fe,i as ye,j as Se,k as ke}from"./flowsProfileThunk-DEvsth7T.js";import"./groupProfileRating-DI2nse-h.js";import{b as ee}from"./userProfileSelector-DVds6RNm.js";import{C as G}from"./confirmModal-DQuz2eI0.js";import{g as we}from"./groupTimeTableForm-DPQyfYJ9.js";import"./pagination-Dn5WTQBc.js";import{u as se}from"./index.esm-X1Z8qUg7.js";import"./workerSelect-CXz8TkGO.js";import"./teachers-BWBVUtcH.js";import"./textArea-xhti2b3I.js";import"./editableCard-DRKBnIvM.js";import{a as Te,F as Ae}from"./flowFilter-ZAiF7tmg.js";import"./groupsList-BPOA2aMN.js";import{t as K}from"./teachingTeacher-CnoExvDG.js";import"./roomsSelectors-Dutms6Wd.js";import"./oftenUsedSelector-DDKSaiMY.js";import"./TransitionGroupContext-DbAT11Dm.js";import"./TransitionGroup-B2vHOldA.js";import"./Transition-C-_OCrFs.js";const Pe="_studentsList_8cx1i_76",$e="_btns_8cx1i_82",De="_btns__inner_8cx1i_88",Ee="_btns__icon_8cx1i_93",qe="_studentsList__container_8cx1i_96",Be="_studentsList__input_8cx1i_122",Oe="_studentsList__delete_8cx1i_125",ze="_studentsList__status_8cx1i_136",Ye="_red_8cx1i_143",Re="_yellow_8cx1i_147",Ve="_addModal_8cx1i_152",Ue="_addModal__header_8cx1i_161",He="_addModal__inner_8cx1i_171",Ge="_addModal__container_8cx1i_177",Je="_check_8cx1i_205",Ke="_status_8cx1i_213",Qe="_active_8cx1i_222",We="_status__inner_8cx1i_225",Xe="_addModal__btn_8cx1i_235",Ze="_deleteForm_8cx1i_239",es="_deleteForm__form_8cx1i_245",ss="_deleteForm__select_8cx1i_254",ts="_deleteForm__btn_8cx1i_258",ns="_teachersModal_8cx1i_262",as="_teachersModal__container_8cx1i_271",rs="_teachersModal__wrapper_8cx1i_322",is="_teachersModal__subject_8cx1i_327",cs="_changeTeacher_8cx1i_336",ls="_changeTeacher__container_8cx1i_341",i={studentsList:Pe,btns:$e,btns__inner:De,btns__icon:Ee,studentsList__container:qe,studentsList__input:Be,studentsList__delete:Oe,studentsList__status:ze,red:Ye,yellow:Re,addModal:Ve,addModal__header:Ue,addModal__inner:He,addModal__container:Ge,check:Je,status:Ke,active:Qe,status__inner:We,addModal__btn:Xe,deleteForm:Ze,deleteForm__form:es,deleteForm__select:ss,deleteForm__btn:ts,teachersModal:ns,teachersModal__container:as,teachersModal__wrapper:rs,teachersModal__subject:is,changeTeacher:cs,changeTeacher__container:ls},os=({activeTeacher:v,setActiveTeacher:L})=>{const{request:P}=X(),{id:d}=m(je),c=Q(),{register:$,handleSubmit:x}=se(),l=W(),g=m(Z),B=m(Ne),N=m(Ie),I=m(Le),M=m(ee),[C,y]=o.useState(!1),[j,p]=o.useState(""),[D,O]=o.useState(),[F,S]=o.useState([]),[k,z]=o.useState([]),[_,w]=o.useState(null),[te,Y]=o.useState([]);o.useEffect(()=>{N&&Y(N)},[N]),o.useEffect(()=>{c(Te())},[]),o.useEffect(()=>{if(g&&d&&M){const s={ignore_teacher:g?.teacher?.id};c(Me({res:s,id:d,branch:M}))}},[d,M]);const ne=()=>{let s=[];F.map(n=>{n?.students?.map(a=>s.push(a))}),c(A({id:d,res:{update_type:"add_students",students:s}}))},ae=()=>{const s={update_type:"remove_students",students:[_?.id]};c(A({id:d,res:s}))},re=s=>{P(`${U}Flow/move-to-flow/?flow_id=${d}&to_flow_id=${s?.to_id}`,"POST",JSON.stringify({students:k}),H()).then(r=>{c(ve(r.errors.map(n=>({type:"error",status:!0,msg:n}))))})},ie=s=>{I.filter(r=>r.id===+s)[0]?.subject.length===1?(c(A({res:{teacher:s,subject:I.filter(r=>r.id===+s)[0]?.subject[0]?.id,level:null},id:d})),c(E({type:"success",status:!0,msg:"Patokni o'qituvchisi o'zgardi"}))):(O(s),p("changeTeacher"))},ce=s=>{const r={...s,teacher:D,level:null};c(A({id:d,res:r}))},le=()=>g?.students?.map(s=>e.jsxs("tr",{children:[e.jsx("td",{children:e.jsx("img",{onClick:()=>l(`../students/profile/${s?.id}`),src:s.img??f,alt:""})}),e.jsx("td",{children:`${s?.surname} ${s?.name}`}),e.jsx("td",{children:s?.phone}),e.jsx("td",{children:s?.parents_phone}),e.jsx("td",{children:e.jsx("div",{className:u(i.studentsList__status,{[i.red]:Number(s.balance)<0,[i.yellow]:Number(s.balance)>0&&Number(s.balance)<1e5}),children:s?.balance})}),C?e.jsxs(e.Fragment,{children:[e.jsx("td",{children:e.jsx(J,{extraClassName:i.studentsList__input,type:"checkbox",onChange:()=>z(r=>r.filter(n=>n===s.id)[0]?r.filter(n=>n!==s.id):[...r,s.id])})}),e.jsx("td",{children:e.jsx("i",{className:u("fas fa-trash",i.studentsList__delete),onClick:()=>w(s)})})]}):null]})),oe=s=>{Y(r=>r.map(n=>n.id===+s?n.isCheck?(S(a=>a.filter(h=>h.classId!==n.id)),{isCheck:!1,id:n.id,students:n.students.map(a=>({isCheck:!1,id:a.id,extra_info:a.extra_info,user:a.user})),class_number:n.class_number,color:n.color}):(S(a=>a.filter(h=>h.classId===n.id)[0]?[...a.filter(h=>h.classId!==n.id),{classId:n.id,students:n?.students?.map(h=>h?.id)}]:[...a,{classId:n.id,students:n?.students?.map(h=>h?.id)}]),{isCheck:!0,id:n.id,students:n.students.map(a=>({isCheck:!0,id:a.id,extra_info:a.extra_info,user:a.user})),class_number:n.class_number,color:n.color}):n))},de=(s,r)=>{S(n=>n.filter(a=>a?.classId===+r)[0]?n.map(a=>{if(a?.classId===r)return{classId:a.classId,students:a.students.includes(+s)?a.students.filter(h=>h!==+s):[...a.students,+s]}}):[...n,{classId:+r,students:[+s]}])};o.useEffect(()=>{Y(s=>s.map(r=>{const n=F.filter(a=>a?.classId===r.id)[0];return n?{isCheck:n?.students?.length===r.students.length,id:r.id,students:r.students.map(a=>n?.students?.includes(a.id)?{isCheck:!0,id:a.id,extra_info:a.extra_info,user:a.user}:{isCheck:!1,id:a.id,extra_info:a.extra_info,user:a.user}),class_number:r.class_number,color:r.color}:r}))},[F]);const _e=()=>te.map((s,r)=>e.jsx(Ae,{flowList:s,onChangeAll:oe,onChangeSingle:de,number:r},r)),ue=()=>I?.map(s=>e.jsxs("tr",{children:[e.jsx("td",{children:e.jsx("img",{src:f,alt:""})}),e.jsx("td",{children:s?.user?.name}),e.jsx("td",{children:s?.user?.surname}),e.jsx("td",{children:e.jsx("div",{className:i.teachersModal__wrapper,children:s?.subject?.map(r=>e.jsx("div",{className:i.teachersModal__subject,children:r?.name?.slice(0,16)}))})}),e.jsx("td",{children:e.jsxs("div",{className:i.check,children:[e.jsx(fe,{activeSwitch:g?.teacher?.id===s?.id,onChangeSwitch:()=>ie(s?.id)}),e.jsx("div",{className:u(i.status,{[i.active]:s?.extra_info?.status}),children:e.jsx("div",{className:u(i.status__inner,{[i.active]:s?.extra_info?.status})})})]})})]})),he=_e(),me=ue(),xe=le();return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:i.studentsList,children:[e.jsxs("div",{className:i.btns,children:[e.jsx("h1",{children:"O’quvchilar ro’yxati"}),e.jsxs("div",{className:i.btns__inner,children:[e.jsx(b,{disabled:k.length===0,type:k.length===0?"disabled":"",onClick:()=>p("change"),children:"Move"}),e.jsx(b,{onClick:()=>p("add"),children:"Add"}),e.jsx("i",{className:u("fas fa-edit",i.btns__icon),onClick:()=>y(!C)})]})]}),e.jsx("div",{className:i.studentsList__container,children:e.jsxs(R,{children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{}),e.jsx("th",{children:"Ism Familya"}),e.jsx("th",{children:"Tel"}),e.jsx("th",{children:"Tel Ota-ona"}),e.jsx("th",{children:"Balans"}),C?e.jsxs(e.Fragment,{children:[e.jsx("th",{}),e.jsx("th",{})]}):null]})}),e.jsx("tbody",{children:xe})]})})]}),e.jsxs(T,{active:j==="add",setActive:p,extraClass:i.addModal,children:[e.jsx("div",{className:i.addModal__header,children:e.jsxs("div",{className:i.addModal__inner,children:[e.jsx("span",{children:"No"}),e.jsx("span",{children:"Sinf Raqami"})]})}),e.jsx("div",{className:i.addModal__container,children:he}),e.jsx(b,{extraClass:i.addModal__btn,onClick:ne,children:"Add"})]}),e.jsxs(T,{extraClass:i.deleteForm,active:j==="change",setActive:p,children:[e.jsx("h1",{children:"Boshqa sinfga qo’shish"}),e.jsxs(V,{extraClassname:i.deleteForm__form,onSubmit:x(re),typeSubmit:"",children:[e.jsx(q,{extraClass:i.deleteForm__select,options:B.filter(s=>s.id!==+d),title:"Patok",register:$,name:"to_id"}),e.jsx(b,{extraClass:i.deleteForm__btn,children:"Add"})]})]}),e.jsx(T,{active:v==="changeTeacher",setActive:L,extraClass:i.teachersModal,children:e.jsx("div",{className:i.teachersModal__container,children:e.jsxs(R,{children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{}),e.jsx("th",{children:"Ism"}),e.jsx("th",{children:"Familya"}),e.jsx("th",{children:"Fanlar"}),e.jsx("th",{children:"Status"})]})}),e.jsx("tbody",{children:me})]})})}),e.jsxs(T,{extraClass:i.changeTeacher,active:j==="changeTeacher",setActive:p,children:[e.jsx("h1",{children:"Fan tanlang"}),e.jsx(V,{extraClassname:i.changeTeacher__container,onSubmit:x(ce),children:e.jsx(q,{title:"Fan",register:$,options:I?.filter(s=>s.id===D)[0]?.subject,name:"subject"})})]}),e.jsx(G,{setActive:w,active:_,onClick:ae,type:"danger"})]})},ds="_flowProfile_1np6n_1",_s="_navigators_1np6n_8",us="_navigatorsItem_1np6n_13",hs="_navigatorsItem__link_1np6n_24",ms="_navigatorsItem__border_1np6n_34",xs="_navigatorsItem__icon_1np6n_39",js="_navigatorsItem__info_1np6n_43",fs="_status_1np6n_53",vs="_active_1np6n_62",gs="_status__inner_1np6n_65",ps="_navigatorsItem__inner_1np6n_75",bs="_navigatorsItem__iconPosition_1np6n_80",Ns="_navigatorsItem__image_1np6n_86",Is="_navigatorsItem__subject_1np6n_90",Ls="_studentsList_1np6n_109",Ms="_btns_1np6n_115",Cs="_btns__inner_1np6n_121",Fs="_btns__icon_1np6n_126",ys="_studentsList__container_1np6n_129",Ss="_studentsList__input_1np6n_155",ks="_studentsList__delete_1np6n_158",ws="_studentsList__status_1np6n_169",Ts="_red_1np6n_176",As="_yellow_1np6n_180",Ps="_infoModal_1np6n_185",$s="_infoModal__btn_1np6n_190",Ds="_form_1np6n_193",Es="_form__input_1np6n_198",t={flowProfile:ds,navigators:_s,navigatorsItem:us,navigatorsItem__link:hs,navigatorsItem__border:ms,navigatorsItem__icon:xs,navigatorsItem__info:js,status:fs,active:vs,status__inner:gs,navigatorsItem__inner:ps,navigatorsItem__iconPosition:bs,navigatorsItem__image:Ns,navigatorsItem__subject:Is,studentsList:Ls,btns:Ms,btns__inner:Cs,btns__icon:Fs,studentsList__container:ys,studentsList__input:Ss,studentsList__delete:ks,studentsList__status:ws,red:Ts,yellow:As,infoModal:Ps,infoModal__btn:$s,form:Ds,form__input:Es},qs=[{img:f,fullName:"Mahmud Yo`Ldoshev",parentTel:"+998909773176",tel:"+998909773176",money:"-10000",checked:!0,deleted:!0},{img:f,fullName:"Mahmud Yo`Ldoshev",parentTel:"+998909773176",tel:"+998909773176",money:"50000",checked:!0,deleted:!0},{img:f,fullName:"Mahmud Yo`Ldoshev",parentTel:"+998909773176",tel:"+998909773176",money:"295 000",checked:!0,deleted:!0},{img:f,fullName:"Mahmud Yo`Ldoshev",parentTel:"+998909773176",tel:"+998909773176",money:"295 000",checked:!0,deleted:!0},{img:f,fullName:"Mahmud Yo`Ldoshev",parentTel:"+998909773176",tel:"+998909773176",money:"295 000",checked:!0,deleted:!0},{img:f,fullName:"Mahmud Yo`Ldoshev",parentTel:"+998909773176",tel:"+998909773176",money:"295 000",checked:!0,deleted:!0}];o.memo(()=>{const[v,L]=o.useState(!1),d=qs.map(c=>e.jsxs("tr",{children:[e.jsx("td",{children:e.jsx("img",{src:c.img,alt:""})}),e.jsx("td",{children:c.fullName}),e.jsx("td",{children:c.tel}),e.jsx("td",{children:c.parentTel}),e.jsx("td",{children:e.jsx("div",{className:u(t.studentsList__status,{[t.red]:Number(c.money)<0,[t.yellow]:Number(c.money)>0&&Number(c.money)<1e5}),children:c.money})}),v?e.jsxs(e.Fragment,{children:[e.jsx("td",{children:e.jsx(J,{extraClassName:t.studentsList__input,type:"checkbox",defaultValue:c.checked})}),e.jsx("td",{children:e.jsx("i",{className:u("fas fa-trash",t.studentsList__delete)})})]}):null]}));return e.jsxs("div",{className:t.studentsList,children:[e.jsxs("div",{className:t.btns,children:[e.jsx("h1",{children:"O’quvchilar ro’yxati"}),e.jsxs("div",{className:t.btns__inner,children:[e.jsx(b,{children:"Move"}),e.jsx(b,{children:"Add"}),e.jsx("i",{className:u("fas fa-edit",t.btns__icon),onClick:()=>L(!v)})]})]}),e.jsx("div",{className:t.studentsList__container,children:e.jsxs(R,{children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{}),e.jsx("th",{children:"Ism Familya"}),e.jsx("th",{children:"Tel"}),e.jsx("th",{children:"Tel Ota-ona"}),e.jsx("th",{children:"Balans"}),v?e.jsxs(e.Fragment,{children:[e.jsx("th",{}),e.jsx("th",{})]}):null]})}),e.jsx("tbody",{children:d})]})})]})});const rt=o.memo(()=>{const{request:v}=X(),{register:L,handleSubmit:P,setValue:d}=se(),c=Q(),$=W(),{id:x}=ge(),l=m(Z),g=m(Ce),B=m(Fe),N=m(ee),I=m(we),[M,C]=o.useState(!1),[y,j]=o.useState(""),[p,D]=o.useState(null),[O,F]=o.useState(!1);o.useEffect(()=>{c(ye({id:x})),c(Se({id:x}))},[x]),o.useEffect(()=>{N&&l&&c(ke({flow:x,branch:N,res:{ignore_students:l?.students.map(_=>_?.id)}}))},[N,l]),o.useEffect(()=>{l&&(d("name",l?.name),d("level",l?.level?.id))},[l]),o.useEffect(()=>{l&&v(`${U}Subjects/level-for-subject/${l?.subject_id}/`,"GET",null,H()).then(_=>{c(pe(_))}).catch(_=>console.log(_))},[l]);const S=()=>{v(`${U}Flow/flow-delete/${x}`,"DELETE",null,H()).then(_=>{$(-2),c(E({type:"success",status:!0,msg:_?.msg}))}).catch(_=>{c(E({type:"error",status:!0,msg:"Databazada hatolik yuzberdi"}))})},k=()=>{F(!0)},z=_=>{const w={..._,subject:p};console.log(w,"log"),c(A({id:x,res:w})),c(E({type:"success",status:!0,msg:"Patokni malumotlari o'zgardi"}))};return B?(y&&j(!1),e.jsx(be,{})):e.jsxs("div",{className:t.flowProfile,children:[e.jsxs("div",{className:t.navigators,children:[e.jsxs("div",{className:t.navigatorsItem,style:{borderColor:"#3B82F6"},children:[e.jsxs("div",{className:t.navigatorsItem__link,children:[e.jsx("p",{children:"Next lesson"}),e.jsx("i",{className:u("fas fa-share",t.navigatorsItem__icon)})]}),e.jsx("div",{className:t.navigatorsItem__border}),e.jsxs("div",{className:t.navigatorsItem__info,children:[e.jsx("h2",{children:g?.day}),e.jsx("h2",{children:g?.hour}),e.jsx("h2",{children:g?.room})]})]}),e.jsxs("div",{className:t.navigatorsItem,style:{borderColor:"#5A588E"},children:[e.jsxs("div",{className:t.navigatorsItem__link,children:[e.jsx("p",{children:"Teacher"}),e.jsx("img",{src:K,alt:""})]}),e.jsx("div",{className:t.navigatorsItem__border}),e.jsxs("div",{className:t.navigatorsItem__info,children:[e.jsx("img",{className:t.navigatorsItem__image,src:f,alt:""}),e.jsx("h2",{children:`${l?.teacher?.surname} ${l?.teacher?.name}`}),e.jsx("h2",{className:t.navigatorsItem__subject,children:l?.subject_name}),e.jsx("i",{className:u("fas fa-edit",t.navigatorsItem__iconPosition),onClick:()=>j("changeTeacher")})]})]}),e.jsxs("div",{className:t.navigatorsItem,style:{borderColor:"#5A588E"},children:[e.jsxs("div",{className:t.navigatorsItem__link,children:[e.jsx("p",{children:"Info"}),e.jsx("img",{src:K,alt:""})]}),e.jsx("div",{className:t.navigatorsItem__border}),e.jsxs("div",{className:t.navigatorsItem__info,children:[e.jsxs("h2",{className:t.navigatorsItem__inner,children:[e.jsx("span",{children:"Name: "}),l?.name]}),l?.level_name?e.jsxs("h2",{className:t.navigatorsItem__inner,children:[e.jsx("span",{children:"Level: "}),l?.level_name]}):null,e.jsxs("h2",{className:t.navigatorsItem__inner,children:[e.jsx("span",{children:"Activity: "}),e.jsx("div",{className:u(t.status,{[t.active]:l?.activity}),children:e.jsx("div",{className:u(t.status__inner,{[t.active]:l?.activity})})})]}),e.jsx("i",{className:u("fas fa-edit",t.navigatorsItem__iconPosition),onClick:()=>j("changeInfo")})]})]})]}),e.jsx(os,{activeTeacher:y,setActiveTeacher:j}),e.jsxs(T,{extraClass:t.infoModal,active:y==="changeInfo",setActive:j,children:[e.jsx("h1",{children:"Ma’lumot o’zgartirish"}),e.jsx(b,{extraClass:t.infoModal__btn,onClick:()=>C(!M),type:"danger",children:"Delete group"}),e.jsxs(V,{id:"formChange",extraClassname:t.form,typeSubmit:"",onSubmit:P(z),children:[e.jsx(J,{extraClassName:t.form__input,placeholder:"Patok nomi",register:L,name:"name",required:!0}),e.jsx(q,{extraClass:t.form__input,options:l?.teacher?.subject,title:"Fan",defaultValue:l?.subject?.id,onChangeOption:D,required:!0}),I.length?e.jsx(q,{extraClass:t.form__input,options:I,title:"Level",register:L,name:"level",defaultValue:l?.level?.id,required:!0}):null,e.jsx(b,{id:"formChange",extraClass:t.infoModal__btn,children:"Change"})]}),e.jsx(G,{setActive:C,active:M,onClick:k,title:"Rostanham o'chirmoqchimisiz ",type:"danger"})]}),e.jsx(G,{type:"danger",active:O,setActive:F,onClick:S})]})});export{rt as FlowProfileNavigators};
