import{a as x,r as t,ab as M,u as L,e as N,A,h as D,j as e,D as R,T as E,ac as q,ad as V,ae as B,af as H,o as G,g as K,ag as U,ah as Y,ai as z,S}from"./index-BM3qoPaZ.js";import{g as J,a as Q,b as W,c as X,p as Z,d as ee,e as te,y as se,f as ae,T as oe}from"./taskManagerRight-B51ror1U.js";import"./textArea-BKEd2Xap.js";import{u as re}from"./index.esm-D0zpTM6p.js";import{C as ce}from"./confirmModal-CQUKf-gX.js";import{e as ne}from"./oftenUsedSelector-DDKSaiMY.js";import"./clsx-B-dksMZM.js";const le="_container_9ej24_2",de="_box_9ej24_10",_e="_box__header_9ej24_20",ie="_select_9ej24_27",he="_box__header_title_9ej24_30",xe="_box__sides_9ej24_38",b={container:le,box:de,box__header:_e,select:ie,box__header_title:he,box__sides:xe},ue="_taskLeft_1yh43_1",fe="_taskLeft__header_1yh43_20",be="_taskLeft__header_box_1yh43_24",je="_taskLeft__header_box_top_1yh43_33",me="_taskLeft__header_box_count_1yh43_41",ke="_taskLeft__body_1yh43_46",ge="_taskLeft__body_table_1yh43_52",pe="_taskLeft__body_main_1yh43_58",Le="_taskLeft__body_title_1yh43_66",ye="_taskLeft__body_card_1yh43_69",ve="_taskLeft__body_card_cotainer_1yh43_74",o={taskLeft:ue,taskLeft__header:fe,taskLeft__header_box:be,taskLeft__header_box_top:je,taskLeft__header_box_count:me,taskLeft__body:ke,taskLeft__body_table:ge,taskLeft__body_main:pe,taskLeft__body_title:Le,taskLeft__body_card:ye,taskLeft__body_card_cotainer:ve},w=t.createContext(null),T=["Tel ko'tardi","Tel ko'tarmadi"],Ce=({formatted:s,setTaskType:r,taskType:d})=>{const u=x(J),_=x(Q),[g,j]=t.useState(null),[k,i]=t.useState(null),h=x(W),[n,m]=t.useState(null),c=M(new Date),[I,y]=t.useState(!1),[O,v]=t.useState(null),{register:Me,handleSubmit:Ne,setValue:Ae}=re(),C=x(X),{request:F}=N();L(),t.useEffect(()=>{h&&y(!1)},[h]);const p={red:[],yellow:[],green:[]};C?.forEach(a=>{p[a?.color]&&p[a?.color].push(a)}),t.useEffect(()=>{j(T[0])},[T]);const P=t.useCallback(a=>{y(!0),v(a),F(`${A}Lead/lead_call/${a.id}`,"GET",null,D()).then(l=>{console.log(l,"nma gap"),m(l.history)}).catch(l=>{console.log(l)})}),$=t.useMemo(()=>({activeModal:I,setActiveModal:a=>P(a),activeModalItem:O,setActiveModalItem:v,taskType:d}),[]);return e.jsxs("div",{className:o.taskLeft,children:[e.jsxs("div",{className:o.taskLeft__header,children:[c===s&&e.jsxs("div",{onClick:()=>r("progress"),className:o.taskLeft__header_box,style:{background:"rgba(249, 145, 75, 1)"},children:[e.jsxs("div",{className:o.taskLeft__header_box_top,children:[e.jsx("img",{src:Z,alt:""}),e.jsxs("h2",{style:{whiteSpace:"pre-line"},children:["Task ",e.jsx("br",{}),"in Progress"]})]}),e.jsx("div",{className:o.taskLeft__header_box_count,children:_})]}),e.jsxs("div",{className:o.taskLeft__header_box,onClick:()=>r("completed"),style:{background:"rgba(26, 174, 204, 1)"},children:[e.jsxs("div",{className:o.taskLeft__header_box_top,children:[e.jsx("img",{src:ee,alt:""}),e.jsxs("h2",{style:{whiteSpace:"pre-line"},children:["Project",e.jsx("br",{}),"Completed"]})]}),e.jsx("div",{className:o.taskLeft__header_box_count,children:u})]})]}),e.jsx(w.Provider,{value:$,children:e.jsxs("div",{className:o.taskLeft__body,children:[e.jsx("h1",{className:o.taskLeft__body_title,children:d==="completed"?"Completed leads":"Leads"}),h?e.jsx(R,{}):s===c?e.jsx(e.Fragment,{children:e.jsx("div",{className:o.taskLeft__body_main,children:e.jsx("div",{className:o.taskLeft__body_card,children:Object.entries(p).map(([a,l])=>l.length?e.jsx(Se,{taskType:d,items:l,className:o.taskLeft__body_card_cotainer},a+d):null)})})}):e.jsx(e.Fragment,{children:e.jsx("div",{className:o.taskLeft__body_table,children:e.jsxs(E,{children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{}),e.jsx("th",{children:"Ism"}),e.jsx("th",{children:"Familiya"}),e.jsx("th",{children:"Kament"}),e.jsx("th",{children:"Tel raqami"}),e.jsx("th",{children:"Tel statusi"}),e.jsx("th",{children:"Yaratilgan sana"})]})}),e.jsx("tbody",{children:C?.map((a,l)=>e.jsxs("tr",{children:[e.jsx("td",{children:l+1}),e.jsx("td",{children:a?.lead?.name}),e.jsx("td",{children:a?.lead?.surname}),e.jsx("td",{children:a?.comment}),e.jsx("td",{children:a?.lead?.phone}),e.jsx("td",{children:a.status===!0?"Tel ko'tardi":"Tel ko'tarilmadi"}),e.jsx("td",{children:a?.lead?.created})]},l))})]})})})]})})]})},Se=({items:s=[],className:r="",taskType:d})=>e.jsxs(E,{children:[e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{children:"â„–"}),e.jsx("th",{children:"Ism"}),e.jsx("th",{children:"Familiya"}),e.jsx("th",{children:"Telefon nomer"})]})}),e.jsx("tbody",{children:s.map((u,_)=>e.jsx(Te,{item:u,i:_},_))})]}),Te=({item:s,i:r})=>{const[d,u]=t.useState({}),{setActiveModal:_,setActiveModalItem:g,taskType:j}=t.useContext(w),[k,i]=t.useState(!1),{request:h}=N(),n=L(),m=c=>{switch(c){case"red":return`url(${ae})`;case"yellow":return`url(${se})`;case"green":return`url(${te})`;default:return""}},f=()=>{h(`${A}Lead/lead_delete/${s.id}`,"DELETE",null,D()).then(c=>{console.log(c),i(!1),n(q(s.id)),n(V(c.accepted_percentage)),n(B(c.completed)),n(H(c.progressing)),n(G({type:"success",status:!0,msg:"Muvaffaqiyatli o'chirildi"}))}).catch(c=>{console.log(c)})};return t.useEffect(()=>{u({backImage:m(s?.color),color:s?.color==="green"?"rgba(220, 252, 231, 1)":s.color==="yellow"?"rgba(254, 249, 195, 1)":"rgba(255, 228, 230, 1)"})},[s?.color]),e.jsxs(e.Fragment,{children:[e.jsxs("tr",{style:{background:d.color},children:[e.jsx("td",{children:r+1}),e.jsx("td",{children:s.name}),e.jsx("td",{children:s.surname}),e.jsx("td",{children:s.phone})]}),e.jsx(ce,{active:k,setActive:i,onClick:f})]})},$e=()=>{const s=L(),[r,d]=t.useState(),{id:u}=x(K),_=x(ne),g=x(U),[j,k]=t.useState(new Date),[i,h]=t.useState("all"),[n,m]=t.useState("progress"),f=M(j);return t.useEffect(()=>{s(Y({operator_id:i,date:f,branch:r,taskType:n}))},[i,f,n,r]),t.useEffect(()=>{s(z(r))},[r]),console.log(r),e.jsx("div",{className:b.container,children:e.jsxs("div",{className:b.box,children:[e.jsxs("div",{className:b.box__header,children:[e.jsx("h1",{className:b.box__header_title,children:"Task Manager"}),e.jsxs("div",{style:{display:"flex",gap:"2rem"},children:[e.jsx(S,{defaultValue:r,onChangeOption:d,options:g,title:"Branch"}),e.jsx(S,{defaultValue:i,onChangeOption:h,extraClass:b.select,title:"Operators",options:[..._,{name:"Hammasi",id:"all"}]})]})]}),e.jsxs("div",{className:b.box__sides,children:[e.jsx(Ce,{setTaskType:m,taskType:n,formatted:f}),e.jsx(oe,{selectedDate:j,setSelectedDate:k})]})]})})};export{$e as AdminTaskManager};
